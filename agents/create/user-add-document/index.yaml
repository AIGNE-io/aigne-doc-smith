type: team
name: userAddDocument
description: Add documents to the documentation structure
skills:
  - url: ../../init/index.mjs
    default_input:
      skipIfExists: true
  - ../../utils/load-sources.mjs
  - ./add-documents-to-structure.mjs
  - url: ../../utils/save-output.mjs
    default_input:
      saveKey: documentStructure
      savePath:
        $get: outputDir
      fileName: structure-plan.json
  - ../../utils/save-sidebar.mjs
  # structure 准备工作
  - ../../utils/ensure-document-icons.mjs
  - ../../utils/add-translates-to-structure.mjs
  - ../../utils/format-document-structure.mjs
  - ../../media/load-media-description.mjs
  - ../../update/batch-generate-document.yaml
  # 批量 generate
  - type: team
    skills:
      - ../../update/check-document.mjs
    iterate_on: newDocuments
    concurrency: 5
  # 查找需要添加链接的文档
  - ./find-documents-to-add-links.yaml
  # review
  - ./review-documents-with-new-links.mjs
  - type: team
    name: batchAddNewLinks
    description: Batch add new links to documents
    skills:
      - ../utils/init-current-content.mjs
      - ../../utils/transform-detail-data-sources.mjs
      - ../../update/update-single/update-single-document-detail.mjs
    iterate_on: documentsWithNewLinks
    concurrency: 5
  - type: team
    name: batchTranslateDocuments
    description: Batch translate documents to multiple languages
    skills:
      - ../../localize/translate-multilingual.yaml
    iterate_on: documentsWithNewLinks
    concurrency: 5
  - ../../utils/post-generate.mjs
  - ./print-add-document-summary.mjs
mode: sequential
