type: team
name: retranslate
alias:
  - rt
  - translate-again
description: Re-translate individual document content to selected languages
skills:
  - url: ./input-generator.mjs
    default_input:
      skipIfExists: true
  - ./load-config.mjs
  - ./load-sources.mjs
  - type: transform
    jsonata: |
      $merge([
        $,
        {
          'structurePlan': originalStructurePlan,
          'structurePlanResult': $map(originalStructurePlan, function($item) {
            $merge([
              $item,
              {
                'translates': [$map(translateLanguages, function($lang) { {"language": $lang} })]
              }
            ])
          })
        }
      ])
  - url: ./find-item-by-path.mjs
    default_input:
      isTranslate: true
  - ./language-selector.mjs
  - type: transform
    jsonata: |
      $merge([
        $,
        {
          'translates': [$map(selectedLanguages, function($lang) { {"language": $lang} })]
        }
      ])
  - ./batch-translate.yaml
  - url: ./save-single-doc.mjs
    default_input:
      isTranslate: true
      isShowMessage: true
input_schema:
  type: object
  properties:
    glossary:
      type: string
      description: Glossary of terms for consistent terminology
    doc-path:
      type: string
      description: Document path to retranslate
    # languages:
    #   type: array
    #   items:
    #     type: string
    #   description: Languages to translate to
    feedback:
      type: string
      description: Feedback for translation improvement
output_schema:
  type: object
  properties:
    title:
      type: string
    description:
      type: string
    path:
      type: string
    content:
      type: string
mode: sequential
