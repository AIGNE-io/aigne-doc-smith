name: generateDocument
description: Comprehensive content generator for documentation that creates detailed, high-quality document content from various data sources with intelligent analysis.
instructions:
  - role: system
    url: ../../prompts/detail/generate/system-prompt.md
  - role: user
    url: ../../prompts/detail/generate/user-prompt.md
input_schema:
  type: object
  properties:
    rules:
      type: string
      description: User's content generation rules and requirements
    locale:
      type: string
      description: User language, such as zh, en
    datasources:
      type: string
      description: Source data and context for document content generation
    targetAudience:
      type: string
      description: Target audience for document content
    nodeName:
      type: string
      description: Document node name for content generation
    originalDocumentStructure: ../schema/document-structure.yaml
    title:
      type: string
    description:
      type: string
    path:
      type: string
    parentId:
      type:
        - string
        - "null"
    glossary:
      type: string
      description: Glossary
    additionalInformation:
      type: string
      description: Additional supplementary information
  required:
    - rules
    - datasources
    - originalDocumentStructure
output_key: content
afs:
  modules:
    - module: system-fs
      options:
        mount: /sources
        path: .
        description: |
          Codebase of the project to be documented used as context for document generation,
          should search and read as needed while generating document content
# skills:
  # FIXME: @zhanghan temporary disable diagram tool
  # - type: team
  #   task_render_mode: collapse
  #   name: generateDiagram
  #   skills:
  #     - ../generate/draw-diagram.yaml
  #     - ../generate/wrap-diagram-code.mjs
  #   reflection:
  #     reviewer: ../generate/check-diagram.mjs
  #     is_approved: isValid
  #     max_iterations: 5
  #     return_last_on_max_iterations: false
  #     custom_error_message: "MUST NOT generate any diagram: validation failed after max iterations."
  #   input_schema:
  #     type: object
  #     properties:
  #       documentContent:
  #         type: string
  #         description: The **raw text content** of the current document. (**Note:** This is the original document and **does not include** any existing diagram source code.)
  #     required:
  #       - documentContent
  #   output_schema:
  #     type: object
  #     properties:
  #       diagramSourceCode:
  #         type: string
  #         description: The **diagram source code** generated from the input text.
