# 品質保証

生成されるすべてのドキュメントが機能的、明確、かつプロフェッショナルであることを保証するため、DocSmithには自動品質保証プロセスが組み込まれています。このプロセスは、公開前にMarkdownコンテンツに対して一連のチェックを実行し、リンク切れから不正な形式の図まで、一般的な問題を検出して報告します。

この自動化されたパイプラインは、コンテンツの構造、リンク、メディア、構文を検証し、一貫した品質基準を維持します。

```d2
direction: down

Input-Markdown-Content: {
  label: "入力: Markdownコンテンツ"
  shape: rectangle
}

QA-Pipeline: {
  label: "QAパイプライン"
  shape: rectangle
  grid-columns: 1
  grid-gap: 50

  Structural-Checks: {
    label: "構造チェック"
    shape: rectangle
    grid-columns: 2
    Completeness: "コンテンツが切り捨てられていないことを保証"
    Code-Blocks: "ブロックの構文とインデントを検証"
  }

  Content-Validation: {
    label: "コンテンツ検証"
    shape: rectangle
    grid-columns: 2
    Link-Integrity: "内部リンクを検証"
    Image-Paths: "ローカル画像の存在を確認"
    Table-Formatting: "列数が一致するか確認"
  }

  Syntax-Validation: {
    label: "構文検証"
    shape: rectangle
    grid-columns: 2
    D2-Diagrams: "D2構文を検証"
    Markdown-Linting: "スタイルルールを強制"
  }
}

Output-Validated-Content-or-Error-Report: {
  label: "出力: 検証済みコンテンツまたはエラーレポート"
  shape: rectangle
}

Input-Markdown-Content -> QA-Pipeline
QA-Pipeline -> Output-Validated-Content-or-Error-Report
```

### 主要な検証領域

DocSmithの品質保証プロセスは、ドキュメントの完全性を保証するため、いくつかの主要な領域をカバーしています。

#### コンテンツの構造と完全性

DocSmithは、コンテンツの構造的完全性を保証するために、いくつかのチェックを実行します：

- **不完全なコードブロック**: ` ``` ` で開始されて閉じられていないコードブロックを検出します。
- **改行の欠落**: 1行に表示されるコンテンツを特定します。これは改行が欠落している可能性を示します。
- **コンテンツの末尾**: コンテンツが適切な句読点（例：`.`, `)`, `|`, `>`）で終わっていることを確認し、出力が切り捨てられるのを防ぎます。
- **コードブロックのインデント**: コードブロックのインデントの不整合を分析します。コード行のインデントが開始の ` ``` ` マーカーよりも少ない場合、レンダリングの問題を引き起こす可能性があります。このチェックは、正しいコードの表示を維持するのに役立ちます。

#### リンクとメディアの整合性

- **リンクの整合性**: ドキュメント内のすべての相対リンクは、ドキュメント構造計画と照らし合わせて検証され、リンク切れを防ぎます。これにより、すべての内部ナビゲーションが期待どおりに機能することが保証されます。チェッカーは外部リンク（`http://` または `https://` で始まる）および `mailto:` リンクを無視します。

- **画像の検証**: 画像の破損を避けるため、チェッカーはドキュメントで参照されているローカル画像ファイルがファイルシステムに存在することを確認します。相対パスと絶対パスの両方を解決して、ファイルの存在を確認します。外部リンクのURLやデータURLはチェックされません。

#### 図の構文検証

- **D2図**: DocSmithは、コードをSVG画像にコンパイルしようとすることでD2図の構文を検証します。このプロセスにより、構文エラーが図の破損につながる前に捕捉されます。

#### フォーマットとスタイルの強制

- **テーブルのフォーマット**: ヘッダー、区切り線、データ行の間で列数が一致しないテーブルを検査します。このチェックにより、一般的なテーブルのレンダリング失敗を防ぎます。

- **Markdownリンティング**: 組み込みのリンターが一貫したMarkdown構造を強制します。主要なルールには以下が含まれます：

| ルールID | 説明 |
|---|---|
| `no-duplicate-headings` | 同じセクション内で同じ内容の複数の見出しを防ぎます。 |
| `no-undefined-references` | すべてのリンクと画像の参照が定義されていることを保証します。 |
| `no-unused-definitions` | 使用されていないリンクや画像の定義にフラグを立てます。 |
| `no-heading-content-indent` | 見出しの内容の前にインデントを許可しません。 |
| `no-multiple-toplevel-headings` | ドキュメントごとにトップレベルの見出し（H1）を1つだけ許可します。 |
| `code-block-style` | コードブロックに一貫したスタイル（例：バッククォートの使用）を強制します。 |

これらのチェックを自動化することで、DocSmithはドキュメントの一貫した基準を維持し、最終的な出力が正確でナビゲート可能であることを保証します。

全体的なアーキテクチャについて詳しく知るには、[仕組み](./advanced-how-it-works.md)のセクションを参照してください。